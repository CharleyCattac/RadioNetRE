# Поток событий
---

# Содержание
1 [Актеры](#actors)  
2 [Варианты использования](#use_cases)  
2.1 [Просмотреть список доступных станций](#available_stations_list_view)  
2.2 [Найти нужную станции](#search)  
2.3 [Слушать желаемую станцию](#listening_to_station)  
2.4 [Приостановить/продолжить воспроизведение](#start_pause)  
2.5 [Сохранить и записать аудио](#save_and_download)  

<a name="actors"/>

# 1 Актеры

В данном приложении только один вид актера - собственно пользователь.  

<a name="use_cases"/>

# 2 Варианты использования

<a name="available_stations_list_view"/>

## 2.1 Просмотреть список доступных станций

**Описание.** Вариант использования "Просмотреть список доступных станций" позволяет пользователю изучить список станций, доступных для прослушивания.  

**Предусловия.** Пользователь зашел в приложение либо воспользовался поиском по предоставленному ранее списку станций.  

### Основной поток:
1. Приложение отображает окно просмотра списка доступных станций (изначально пустое);
2. Приложение накладывает элемент загрузки поверх предыдущего окна, запрашивая метаданые;
3. По заверешении обработки запроса элемент загрузки исчезает;
4. Если не обнаружено ни одной доступной станции, выполняется альтернативный поток А1;
5. Если отсутствует подключение к Интернету, выполняется поток ошибки Е1;
6. Приложение формирует список из первых 30 найденных станций, по мере прокрутки ползунка пользователем подгружает остальные;
7. Вариант использования завершается;  

**Альтернативный поток А1:**
1. Приложение сообщает об отсутствии доступных станций;
2. Возврат к п.1 основного потока.

**Поток ошибки Е1:**
1. Приложение сообщает пользователю об отсутствии подключения к Интернету;
2. Возврат к п.1 основного потока.

<a name="search"/>

## 2.2 Найти нужную станции

**Описание.** Вариант использования "Найти нужную станции" позволяет пользователю найти определенную станцию из общего списка доступных станций.  

**Предусловия.** Пользователь нажал на кнопку поиска в верхней части экрана.  

### Основной поток:
1. Приложение открывает окно поиска и отображает историю поиска под окном ввода;
2. Пользователь вводит данные для поиска;
3. Пользователь нажимает кнопку для отправки запроса;
4. Запускается вариант использования "Просмотр списка доступных станций", однако выводятся только те станции, которые попадают под критерий поиска;   
5. Вариант использования завершается.

<a name="listening_to_station"/>

## 2.3 Слушать желаемую станцию

**Описание.** Вариант использования "Слушать желаемую станцию" осуществляет воспроизведение аудио-потока.  

**Предусловия.** Пользователь выбрал определенную станцию из списка доступных станций.  

### Основной поток:
1. Приложение запрашивает метаданные выбранной станции с сервера;  
2. Если отсутствует подключение к Интернету либо происходит ошибка парсинга метаданных, выполняется поток ошибки Е2; 
3. Приложение производит парсинг метаданных и начинает воспроизведение аудио-поток;
4. Вариант использования завершается.

**Поток ошибки Е2:**
1. Приложение сообщает пользователю о произошедшей ошибке;  
2. Вариант использования преждевременно завершается.

<a name="start_pause"/>

## 2.4 Приостановить/продолжить воспроизведение

**Описание.** Вариант использования "Приостановить/продолжить воспроизведение" останавливает либо продолжает трансляцию аудио-потока, получаемого с сервера.  

**Предусловия.** Пользователь нажал на кнопку "Старт/Пауза" в низу экрана.

### Основной поток:
1. Приложение анализирует, какое действие было запрошено;
2. Если была выбрана приостановка воспроизведения, выполняется выполняется альтернативный поток А2;
3. Если было выбрано продолжение воспроизведения, выполняется выполняется альтернативный поток А3;
4. Вариант использования завершается.

**Альтернативный поток А2:**
1. Приложение прекращает трансляцию аудио-потока; 
2. Возврат к п.4 основного потока.  

**Альтернативный поток А3:**
1. Приложение переходит к варианту использования "Прослушивание желаемой станции";  
2. Возврат к п.4 основного потока.  

<a name="save_and_download"/>

## 2.5 Сохранить и записать аудио

**Описание.** Вариант использования "Сохранить и записать аудио" выполняет запись аудио-потока в файл и его сохранение в памяти успройства.  

**Предусловия.** Пользователь нажал на кнопку вспомогательного меню и выбрал опцию "Запись".  

### Основной поток:
1. Во вкладке вспомогательного меню опция "Запись" сменяется опцией "Остановка записи";
2. Приложение посылает запрос на начало записи;  
3. Если произошла ошибка, выполняется поток ошибки Е3; 
4. Пользователь выбирает опцию "Остановка записи";
5. Если произошла ошибка, выполняется поток ошибки Е4; 
6. Приложение сохраняет созданный файл в память устройства;  
7. Вариант использования завершается.

**Поток ошибки Е3:**
1. Приложение сообщает пользователю о невозможности начала записи;
2. Вариант использования завершается.

**Поток ошибки Е4:**
1. Приложение сообщает пользователю о возникшей ошибке;
2. Вариант использования завершается.
